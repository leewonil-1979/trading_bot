# 📊 데이터 수집 현황 (2025-11-27)

## ✅ 수집 완료된 데이터 (총 40개 컬럼)

### 1. 📈 가격 데이터 (6개) - 100% 완료
| 컬럼 | 설명 | 데이터 비율 | 출처 |
|------|------|------------|------|
| open | 시가 | 99.7% | FinanceDataReader |
| high | 고가 | 99.7% | FinanceDataReader |
| low | 저가 | 99.7% | FinanceDataReader |
| close | 종가 | 100% | FinanceDataReader |
| volume | 거래량 | 99.1% | FinanceDataReader |
| change_pct | 등락률 | 94.8% | 계산 |

### 2. 💰 투자자 매매 (4개) - 86% 완료
| 컬럼 | 설명 | 데이터 비율 | 출처 | 기간 |
|------|------|------------|------|------|
| foreign_net | 외국인 순매수 | 93.6% | pykrx | 3년 |
| institution_net | 기관 순매수 | 71.4% | pykrx | 3년 |
| individual_net | 개인 순매수 | 94.7% | pykrx | 3년 |
| program_net | 프로그램 순매수 | **2.2%** | 네이버 증권 | **최근 15일만** |

**⚠️ 프로그램 매매 제한 사항:**
- 네이버 증권은 최근 15일치만 제공
- 나머지 ~650일은 데이터 없음 (0으로 표시)

### 3. 📰 뉴스/공시 (4개) - 0% (수집 실패)
| 컬럼 | 설명 | 데이터 비율 | 상태 |
|------|------|------------|------|
| news_count | 뉴스 건수 | 0% | ❌ 크롤링 실패 |
| sentiment_score | 감성 점수 | 0% | ❌ 크롤링 실패 |
| disclosure_count | 공시 건수 | 0% | ❌ 더미 데이터 |
| disclosure_impact | 공시 영향도 | 0% | ❌ 더미 데이터 |

### 4. 📊 기술적 지표 (17개) - 100% 완료
| 컬럼 | 설명 | 데이터 비율 |
|------|------|------------|
| ma5, ma20, ma60 | 이동평균 | 100% |
| volume_ma20, volume_spike | 거래량 지표 | 99%+ |
| rsi | RSI 지표 | 100% |
| macd, macd_signal, macd_diff | MACD 지표 | 100% |
| bb_upper, bb_middle, bb_lower, bb_width | 볼린저밴드 | 100% |
| stoch_k, stoch_d | 스토캐스틱 | 98%+ |
| atr | ATR (변동성) | 100% |
| daily_return | 일일 수익률 | 94.8% |

### 5. 🎯 급락/반등 라벨 (7개) - 100% 완료
| 컬럼 | 설명 | 데이터 비율 |
|------|------|------------|
| crash | 급락 여부 | 0.9% (11,813건) |
| crash_rate | 급락률 | 0.9% |
| rebound_d1 | 1일 후 반등률 | 94.8% |
| rebound_d2 | 2일 후 반등률 | 97.1% |
| rebound_d5 | 5일 후 반등률 | 97.4% |
| hold_days | 보유 기간 | 100% |
| success | 반등 성공 여부 | 0.5% (6,993건) |

### 6. 🏷️ 종목 정보 (2개) - 100% 완료
- stock_code: 종목 코드
- stock_name: 종목명

---

## 🚨 프로그램 매매 3년치 데이터 수집 방법

### ❌ 불가능한 방법
1. **네이버 증권**: 최근 15일만 제공
2. **pykrx**: 프로그램 매매 데이터 없음
3. **FinanceDataReader**: 프로그램 매매 데이터 없음

### ✅ 가능한 방법

#### **Option 1: 증권사 API (유료/계좌 필요)**
**키움증권 OpenAPI**
- 비용: 무료 (계좌 필요)
- 가입: 키움증권 계좌 개설 후 API 신청
- 장점: 과거 데이터 조회 가능
- 단점: 계좌 필요, 복잡한 설정
- URL: https://www3.kiwoom.com/nkw.OpenAPI.Introduction

**LS증권 XingAPI**
- 비용: 무료 (계좌 필요)
- 가입: LS증권 계좌 + API 신청
- 장점: REST API 제공
- 단점: 계좌 필요
- URL: https://www.ebestsec.co.kr/

**한국투자증권 API**
- 비용: 무료 (계좌 필요)
- 가입: 계좌 개설 + APP key 발급
- 장점: 모던한 REST API
- 단점: 계좌 필요
- URL: https://apiportal.koreainvestment.com/

#### **Option 2: 한국거래소 데이터 (유료)**
**KRX 정보데이터시스템**
- 비용: 유료 (월 수십만원)
- URL: https://data.krx.co.kr/
- 장점: 공식 데이터
- 단점: 비용 발생

#### **Option 3: 데이터 판매 업체 (유료)**
**와이즈리포트, 에프앤가이드 등**
- 비용: 유료
- 장점: 정제된 데이터
- 단점: 비용 발생

---

## 💡 현실적인 해결 방안

### **추천 1: pykrx 상세 투자자 데이터 활용**
프로그램 매매 대신 더 상세한 투자자 구분 사용:

```python
from pykrx import stock

# 투자자별 상세 데이터
df = stock.get_market_trading_value_by_investor(
    '20250101', '20251127', '005930', 'KOSPI'
)

# 제공 데이터:
# - 금융투자 (증권사)
# - 보험
# - 투신 (펀드)
# - 사모펀드
# - 은행
# - 기타금융
# - 연기금 (국민연금 등)
# - 기관합계
# - 기타법인
# - 개인
# - 외국인
```

**장점:**
- ✅ 3년치 전체 데이터 가능
- ✅ 무료
- ✅ 프로그램 매매보다 더 상세한 정보

**참고:**
- 프로그램 매매 ≈ 기관 단기 매매의 일부
- 금융투자(증권사) 데이터가 프로그램 매매와 유사할 수 있음

### **추천 2: 최근 15일 데이터만 활용**
급락 후 반등 예측에는 **최근 데이터가 더 중요**:

```python
# 현재 상태:
# - program_net: 최근 15일만 실제 데이터
# - 나머지: 0

# 급락은 최근에 발생
# → 최근 15일 프로그램 매매 데이터로 충분
# → 3년 전 패턴은 현재와 다를 수 있음
```

### **추천 3: 증권사 계좌 개설 (무료)**
가장 현실적인 방법:

1. **키움증권 계좌 개설** (비대면 가능)
2. **OpenAPI 신청** (무료)
3. **과거 프로그램 매매 데이터 조회**

**소요 시간:**
- 계좌 개설: 1~2일
- API 신청: 즉시
- 데이터 수집 코드 작성: 1일
- 총 3~4일

---

## 📋 통합 파일 재생성 필요

**현재 문제:**
- 개별 파일: program_net 15일치 있음 ✅
- 통합 파일: program_net 0% ❌

**해결:**
통합 파일 재생성 필요 (crash_rebound_collector.py의 병합 로직 실행)

---

## 🎯 다음 단계 권장사항

### **즉시 진행 가능:**
1. ✅ 통합 파일 재생성 (program_net 반영)
2. ✅ 상관관계 분석 (현재 데이터로도 가능)
3. ✅ AI 모델 학습 (program_net 최근 15일만으로도 충분)

### **추가 개선 (선택):**
1. ⏳ pykrx 상세 투자자 데이터 추가 수집
2. ⏳ 키움증권 계좌 개설 후 3년치 프로그램 매매 수집
3. ⏳ 뉴스 크롤링 재시도 (현재 실패)
4. ⏳ DART API 키 발급 후 공시 데이터 수집

---

## 📞 추가 정보

**생성 일시:** 2025-11-27
**총 데이터:** 1,374,025행 × 40개 컬럼
**총 종목:** 2,193개
**기간:** 2022-11-27 ~ 2025-11-26 (3년)
